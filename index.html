/index.html
<!DOCTYPE html>
<html lang="ja">


  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      padding: 10px;
      font-family: sans-serif;
      background: #f0f8ff url('https://iccarcgis.maps.arcgis.com/sharing/rest/content/items/eb1fe275b5e84701b7f804c8d8a0704b/data') no-repeat center center fixed;
      background-size: cover;
    }
    h1 {
      text-align: center;
      margin-bottom: 10px;
    }
    #age-buttons {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      max-width: 400px;
      margin: 0 auto 20px auto;
    }
    #age-buttons button {
      padding: 12px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 6px;
      border: 1px solid #888;
      background-color: white;
      transition: background-color 0.3s;
      flex: 1 1 30%;
      min-width: 100px;
    }
    #age-buttons button:hover {
      background-color: #d0eaff;
    }
    #tanzaku-list {
      max-width: 400px;
      margin: 0 auto;
      list-style: none;
      padding: 0;
    }
    #tanzaku-list li {
      background: #fff9e6; /* 薄いクリーム色 */
      border: 4px double #2e7d32; /* 緑の二重線 */
      border-radius: 8px;
      padding: 12px 16px;
      margin-bottom: 10px;
      box-shadow: 0 1px 3px rgb(0 0 0 / 0.1);
      cursor: pointer;
      display: block;
      font-size: 16px;
      line-height: 1.4;
      white-space: pre-wrap;
      color: #333;
    }
    #tanzaku-list li .penname {
      font-size: 14px;
      color: #2e7d32;
      margin-top: 8px;
      text-align: right;
      font-weight: bold;
    }
    #tanzaku-list li.expanded {
      background-color: #e0f0ff;
    }
  </style>
</head>
<body>

<h1>短冊ビューア（スマホ版・枠あり）</h1>

<div id="age-buttons">
  <button onclick="filterByAge('10代以下')">10代以下</button>
  <button onclick="filterByAge('20代')">20代</button>
  <button onclick="filterByAge('30代')">30代</button>
  <button onclick="filterByAge('40代')">40代</button>
  <button onclick="filterByAge('50代')">50代</button>
  <button onclick="filterByAge('60代')">60代</button>
  <button onclick="filterByAge('70代')">70代</button>
  <button onclick="filterByAge('80代以上')">80代以上</button>
  <button onclick="filterByAge()">全て表示</button>
</div>

<ul id="tanzaku-list"></ul>

<script>
  const list = document.getElementById("tanzaku-list");
  const ageField = "field_4";
  let currentWhere = "1=1";

  function fetchAndDisplay() {
    const url = `https://services5.arcgis.com/oISMFKlA90RsGqBJ/arcgis/rest/services/survey123_428ee531d6f64629ad1fb10db7e23778_results/FeatureServer/0/query?where=${encodeURIComponent(currentWhere)}&outFields=field_1,field_2,${ageField}&orderByFields=objectid desc&resultRecordCount=100&f=json`;

    fetch(url)
      .then(res => res.json())
      .then(data => {
        const features = data.features || [];
        displayList(features);
      });
  }

  function displayList(features) {
    list.innerHTML = "";
    features.forEach(feature => {
      const attr = feature.attributes;
      const penname = attr["field_1"] || "";
      const wish = attr["field_2"] || "";
      const li = document.createElement("li");

      li.innerHTML = `
        ${wish}
        <div class="penname">★ ${penname}</div>
      `;

      li.onclick = () => {
        if (li.classList.contains("expanded")) {
          li.classList.remove("expanded");
        } else {
          document.querySelectorAll("#tanzaku-list li.expanded").forEach(el => el.classList.remove("expanded"));
          li.classList.add("expanded");
        }
      };

      list.appendChild(li);
    });
  }

  function filterByAge(ageGroup) {
    currentWhere = ageGroup ? `field_4='${ageGroup}'` : "1=1";
    fetchAndDisplay();
  }

  fetchAndDisplay();
</script>

</body>
</html>
